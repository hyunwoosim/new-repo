<!DOCTYPE html>
<html lang='en'>
<head>
		<meta charset='UTF-8'>
		<title>2조 팀플(스쿨마다 타이틀이 다르기 떄문에 category 적용 해야함)</title>
		<!-- include libraries(jQuery, bootstrap) -->
		<link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
		<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

		<!-- include summernote css/js -->
		<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
		<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
</head>
<body>

<form action="add" data-th-action="@{add}" enctype='multipart/form-data' method='post'>
		<!--  schoolNo의 값을 넘기기 위해 히든으로 설정  -->
		<input type="hidden" name="schoolNo" value="1"> <!-- 로그인 구현이 안되어있어서 임의로 적용 -->
		<input type="hidden" name="no" value="1"> <!-- 로그인 구현이 안되어있어서 임의로 적용 -->
		<div>
				<textarea id="summernote" name='content'></textarea>
		</div>

		<div>
				<!-- 공지로 등록하는 체크박스 -->
				<!--   gradeMd =  체크박스는 관리자만 보이게 설정     -->
				<!--   gradeMdLabel =  공지로등록이라는 텍스트는 관리자만 보이게 설정     -->
				<label for="gradeMd" id="gradeMdLabel" style="display: none;">공지로 등록</label>
				<input type="checkbox" id="gradeMd" name="post" value="1" style="display: none;">
				<button id="btn_submit">등록</button>
		</div>
</form>


<script>
		$(document).ready(function() {
				$('#summernote').summernote({
						height: 300,
						width: 500,
						callbacks: {
								onInit: function() {
										console.log('Summernote 생성됨!');
								},
								onImageUpload: function(files) {

										let data = new FormData();
										for (const file of files) {
												data.append("files", file);
										}
										$.ajax({
												url: 'file/upload', // 절대경로: http://localhost:8888/board2/file/upload
												type: 'POST',
												dataType: 'json',
												contentType: false,
												processData: false,
												data: data
										})
												.done(function(result) {
												if (result.length == 0) {
														alert('로그인 하세요!');
														return;
												}

												// 서버에서 받은 업로드 파일 이름을 가지고 <img> 태그를 설정한다.
												for (const attachedFile of result) {
														$('#summernote').summernote('insertImage',
																'https://kr.object.ncloudstorage.com/moyeorastorage/post/'
																+ attachedFile.filePath);
												}
										});

								}
						}
				});

		});

		//     // 서버에서 사용자의 등급 정보를 전달합니다.
		//        var userGrade = "${userGrade}"; // "매니저" 또는 "부매니저"를 나타내는 값
		//
		//        // "매니저" 또는 "부매니저"인 경우 체크박스를 보이도록 설정
		//        if (userGrade === "admin" || userGrade === "sub-admin") {
		//            $('#gradeMd').show();
		//            $('#gradeMdLabel').show();
		//        }

</script>

</body>
</html>

